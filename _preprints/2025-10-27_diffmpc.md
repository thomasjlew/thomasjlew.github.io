---
title: "Differentiable Model Predictive Control on the GPU"
collection: publications
permalink: /publication/diffmpc
excerpt: '<br />
[Project Page](/publication/diffmpc) / 
[Paper](https://arxiv.org/abs/2510.06179) / 
[Code](https://github.com/ToyotaResearchInstitute/diffmpc) / 
[Video](https://www.youtube.com/watch?v=r42iJBw-L4E) - Scaling up differentiable optimization on the GPU.'
date: 2025-10-07
venue: 'Under Review'
# venuetype: "conference"
paperauthors: 'E. Adabag, M. Greiff, J. Subosits, T. Lew'
thumbnail: "diffmpc/supra_puddle_small.jpg"
paperurl: 'https://arxiv.org/abs/2510.06179'
---

[[Paper](https://arxiv.org/abs/2510.06179)] 
[[Code](https://github.com/ToyotaResearchInstitute/diffmpc)]
[[Video](https://www.youtube.com/watch?v=r42iJBw-L4E)] 

Differentiable model predictive control (MPC) offers a powerful framework for combining learning and control. However, its adoption has been limited by the inherently sequential nature of traditional optimization algorithms, which are challenging to parallelize on modern computing hardware like GPUs.

In this work, we tackle this bottleneck by introducing a GPU-accelerated differentiable optimization tool for MPC. This solver leverages sequential quadratic programming and a custom preconditioned conjugate gradient (PCG) routine with tridiagonal preconditioning to exploit the problem's structure and enable efficient parallelization. 

<p align="center">
  <img src="/images/diffmpc/diffmpc.png" alt="Differentiable MPC algorithm." width="50%">
</p>

We demonstrate substantial speedups over CPU- and GPU-based baselines, significantly improving upon state-of-the-art training times on benchmark reinforcement learning and imitation learning tasks.

![diffmpc_speedups](/images/diffmpc/speedups.png)

We showcase the method on the challenging task of reinforcement learning for driving at the limits of handling, where it enables robust drifting of a Toyota Supra through water puddles [(link to video)](https://www.youtube.com/watch?v=r42iJBw-L4E)].

![diffmpc_supra](/images/diffmpc/supra_puddle.jpg)

Our differentiable MPC library in JAX is available at:
[github.com/ToyotaResearchInstitute/diffmpc](https://github.com/ToyotaResearchInstitute/diffmpc)